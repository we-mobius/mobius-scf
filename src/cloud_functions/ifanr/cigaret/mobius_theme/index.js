!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var a in n)("object"==typeof exports?exports:e)[a]=n[a]}}(global,(function(){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){const{main:a}=n(1);t.main=a},function(e,t,n){const{makeSuccessResponse:a,makeFailResponse:o,makeErrorResponse:r}=n(2),s=BaaS,u=async e=>{const{action:t}=e;let n;switch(t){case"get":n=await(async e=>{try{const{id:t}=e.token.data;let n;const o=new s.TableObject("mobius_theme"),r=new s.Query;r.compare("unique_id","=",t);const u=await o.setQuery(r).find();return n=200===u.status&&u.data.meta.total_count>0?u.data.objects[0].theme:null,a({id:t,theme:n})}catch(e){return r(e)}})(e);break;case"set":n=await(async e=>{try{const{id:t}=e.token.data,n=e.payload;let r;const u=new s.TableObject("mobius_theme"),c=new s.Query;c.compare("unique_id","=",t);const i=await u.setQuery(c).find();if(200===i.status){if(i.data.meta.total_count>0){const e=i.data.objects[0]._id,t=u.getWithoutData(e);t.patchObject("theme",n.theme),r=await t.update()}else{const e=u.create();e.set({...n,unique_id:t}),r=await e.save()}delete r.headers,r=a(r)}else r=o(i.status);return r}catch(e){return r(e)}})(e);break;default:n=o('Expected an "action" param witch should be "get" or "set"')}return n};e.exports={main:async e=>{const t=e.data;let n;const a=await s.request.get("https://users.authing.cn/authing/token?access_token="+t.token).then(e=>e.data);return n=!0===a.status?await u({...t,token:a.token}):o(a),r=n,{content:JSON.stringify(r),content_type:"application/json",status_code:200};var r}}},function(e,t){const n=e=>({status:e,status_message:"",data:{}});e.exports={makeSuccessResponse:e=>{const t=n("success");return t.data=e,t},makeFailResponse:e=>{const t=n("fail");return t.status_message=e,t},makeErrorResponse:e=>{const t=n("error");return t.status_message=e,t}}}])}));